<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>玄机--第一章--webshell查杀</title>
      <link href="/2024/11/13/%E7%8E%84%E6%9C%BA-web%E6%9F%A5%E6%9D%80/"/>
      <url>/2024/11/13/%E7%8E%84%E6%9C%BA-web%E6%9F%A5%E6%9D%80/</url>
      
        <content type="html"><![CDATA[<h2 id="玄机-第一章-应急响应"><a href="#玄机-第一章-应急响应" class="headerlink" title="[玄机]第一章 应急响应"></a>[玄机]第一章 应急响应</h2><h2 id="webshell查杀"><a href="#webshell查杀" class="headerlink" title="webshell查杀"></a>webshell查杀</h2><p>我这里使用Tabby Terminal进行远程连接</p><p>1.黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</p><p>分析webshell可以利用在线工具 也可以手敲命令</p><p><strong>1.在线工具 我这里用的有D盾和微步云沙箱(<a href="https://s.threatbook.com/">https://s.threatbook.com/</a>)</strong></p><p>Tabby连接后直接把 var&#x2F;www&#x2F;html 下的全部文件拉出来</p><p>或者</p><p>使用命令</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`&#123;</span><br><span class="line">scp -r root@ip:/var/www/html ~/桌面/yingji</span><br><span class="line">&#125;`</span><br></pre></td></tr></table></figure><p>放入网页分析即可</p><p><strong>2.列出几个常用的分析命令</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">`&#123;</span><br><span class="line">find ./ type f -name &quot;*.jsp&quot; | xargs grep &quot;exec(&quot; </span><br><span class="line">find ./ type f -name &quot;*.php&quot; | xargs grep &quot;eval(&quot; </span><br><span class="line">find ./ type f -name &quot;*.asp&quot; | xargs grep &quot;execute(&quot; </span><br><span class="line">find ./ type f -name &quot;*.aspx&quot; | xargs grep &quot;eval(&quot; </span><br><span class="line">&#125;`</span><br></pre></td></tr></table></figure><p><code>find ./ -type f</code> 就是查找当前目录及其子目录中的所有普通文件（即不是目录、设备文件等）</p><p><code>xargs</code> 的作用是接收 <code>find</code> 命令返回的文件路径列表，并将它们传递给 <code>grep</code> 命令进行处理</p><p><code>| xargs grep &quot;eval(&quot;</code>：将查找到的每个 <code>.php</code> 文件传递给 <code>grep</code> 命令，查找文件中是否包含 <code>eval(</code> 关键字</p><p>这里用find .&#x2F; type f -name “*.php” | xargs grep “eval(“ </p><p>可以看到三个文件</p><p>2.黑客使用的什么工具的shell github地址的md5 flag{md5}</p><p>查看gz.php的代码特征</p><p>明显的哥斯拉特征  <a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a> </p><p>再MD5加密即可</p><p>3.黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</p><p>既然说是隐藏了 </p><p>这里要用ls -al才能看到文件名</p><p>在include&#x2F;Db 目录下找到隐藏的文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">`&#123;</span><br><span class="line">root@ip-10-0-10-3:/var/www/html/include/Db# ls -la</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x 2 www-data www-data 4096 Aug  2  2023 .</span><br><span class="line">drwxr-xr-x 4 www-data www-data 4096 Aug  2  2023 ..</span><br><span class="line">-rw-r--r-- 1 www-data www-data  768 Aug  2  2023 .Mysqli.php</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 4752 Mar 14  2021 Mysqli.php</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 4921 Mar 14  2021 Mysql.php</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 4433 Mar 14  2021 Sqlite.php</span><br><span class="line">&#125;`</span><br></pre></td></tr></table></figure><p>pwd查看当前目录</p><p>&#x2F;var&#x2F;www&#x2F;html&#x2F;include&#x2F;Db&#x2F;.Mysqli.php</p><p>md5加密即可</p><p>4.黑客免杀马完整路径 md5 flag{md5}</p><p>免杀马 我们正常扫描扫不到</p><p>这种情况我们就要访问日志 在日志中看是否有可疑的地方</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">`&#123;</span><br><span class="line">cd var/log   </span><br><span class="line">cd apache2</span><br><span class="line">cat access.log</span><br><span class="line">&#125;`</span><br></pre></td></tr></table></figure><p>目录：&#x2F;wap&#x2F;top.php</p><p>完整路径为：&#x2F;var&#x2F;www&#x2F;html&#x2F;wap&#x2F;top.php</p><h3 id="websehll代码特征"><a href="#websehll代码特征" class="headerlink" title="websehll代码特征"></a>websehll代码特征</h3><h4 id="1-php危险函数"><a href="#1-php危险函数" class="headerlink" title="1.php危险函数"></a>1.php危险函数</h4><p>eval() system() exec() shell_exec() passthru() （命令执行）</p><p>fopen() fwrite() file_get_contents() file_put_contents()  （文件操作）</p><p>fsockopen() curl_exec() file_get_contents(‘http:&#x2F;&#x2F;…’) （网络操作）</p><h4 id="2-ASP-JSP"><a href="#2-ASP-JSP" class="headerlink" title="2.ASP,JSP"></a>2.ASP,JSP</h4><p> ASP：Execute() Eval() CreateObject()  （命令执行）</p><p>JSP：Runtime.getRuntime().exec()  （命令执行）</p><p>ASP：FileSystemObject() （文件操作）</p><p>ASP：WinHttp.WinHttpRequest  （网络操作）</p><h4 id="3-编码和解码"><a href="#3-编码和解码" class="headerlink" title="3.编码和解码"></a>3.编码和解码</h4><p>常见的编解码函数</p><h3 id="常见网站日志的命令（默认路径）"><a href="#常见网站日志的命令（默认路径）" class="headerlink" title="常见网站日志的命令（默认路径）"></a>常见网站日志的命令（默认路径）</h3><h4 id="一-IIS-windows默认服务器"><a href="#一-IIS-windows默认服务器" class="headerlink" title="一.IIS(windows默认服务器)"></a>一.IIS(windows默认服务器)</h4><p>IIS6.0及更早版本：</p><p>C:\WINDOWS\system32\LogFiles\W3SVC[SiteID]\</p><p>IIS7.0及更高版本：</p><p>C:\inetpub\logs\LogFiles\W3SVC[SiteID]\</p><h4 id="二-Apache-Windows"><a href="#二-Apache-Windows" class="headerlink" title="二.Apache(Windows)"></a>二.Apache(Windows)</h4><p>如果在Windows上安装了Apache，日志文件默认存储在安装目录下的logs文件夹中：</p><p>C:\Program Files (x86)\Apache Group\Apache2\logs\</p><p>or</p><p>C:\Program Files\Apache Group\Apache2\logs\</p><h4 id="三-Apache-Linux"><a href="#三-Apache-Linux" class="headerlink" title="三.Apache(Linux)"></a>三.Apache(Linux)</h4><p>正常访问日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log    或者    &#x2F;var&#x2F;log&#x2F;httpd&#x2F;access_log</p><p>错误日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log    或者    &#x2F;var&#x2F;log&#x2F;httpd&#x2F;error_log</p><p><strong>在Debian&#x2F;Ubuntu上通常使用&#x2F;var&#x2F;log&#x2F;apache2&#x2F;，而在Red Hat&#x2F;CentOS上通常使用&#x2F;var&#x2F;log&#x2F;httpd&#x2F;</strong></p><h4 id="四-Nginx"><a href="#四-Nginx" class="headerlink" title="四.Nginx"></a>四.Nginx</h4><p>正常访问日志：</p><p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>错误日志：</p><p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log</p>]]></content>
      
      
      <categories>
          
          <category> -应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -玄机 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
